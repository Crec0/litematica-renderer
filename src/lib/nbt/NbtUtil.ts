import { inflate } from "pako";
import { NbtReader } from "./NbtReader";
import { compressionMethod, CompressionType } from "./CompressionUtil"
import { Structure } from "deepslate";


export const Tags = [
    'end',
    'byte',
    'short',
    'int',
    'long',
    'float',
    'double',
    'byteArray',
    'string',
    'list',
    'compound',
    'intArray',
    'longArray',
]

export function parseNbt(byteBuffer: Uint8Array, simplified: boolean = false) {
    const uncompressedBuffer = compressionMethod(byteBuffer) == CompressionType.UNCOMPRESSED
        ? byteBuffer
        : inflate(byteBuffer);

    const nbtReader = new NbtReader(uncompressedBuffer)
    return nbtReader.read(simplified);
}

export const TUNNEL_BORE = new Uint8Array([31, 139, 8, 0, 0, 0, 0, 0, 0, 255, 173, 86, 205, 110, 19, 49, 16, 158, 100, 147, 118, 147, 182, 82, 11, 229, 87, 32, 1, 103, 14, 80, 113, 66, 28, 128, 22, 68, 37, 10, 21, 45, 92, 131, 187, 59, 73, 172, 122, 237, 197, 118, 72, 219, 3, 226, 17, 56, 240, 20, 21, 55, 36, 36, 94, 130, 167, 224, 25, 184, 128, 84, 198, 217, 191, 176, 93, 210, 18, 113, 218, 245, 174, 231, 251, 102, 190, 25, 143, 167, 13, 208, 134, 217, 23, 216, 227, 74, 26, 122, 123, 41, 37, 139, 48, 108, 67, 99, 139, 31, 160, 7, 181, 3, 0, 240, 232, 185, 127, 116, 116, 244, 139, 158, 123, 244, 252, 9, 243, 48, 247, 80, 168, 96, 119, 203, 50, 139, 134, 182, 52, 205, 114, 227, 226, 251, 69, 128, 215, 47, 238, 175, 1, 171, 205, 220, 247, 65, 189, 185, 124, 254, 234, 167, 235, 224, 173, 127, 248, 254, 17, 96, 190, 254, 227, 243, 225, 131, 22, 248, 143, 164, 229, 150, 143, 204, 28, 187, 191, 169, 12, 173, 149, 76, 217, 192, 177, 165, 172, 123, 244, 108, 64, 11, 150, 10, 182, 77, 38, 208, 90, 108, 211, 159, 75, 62, 52, 158, 145, 187, 176, 16, 113, 137, 129, 102, 93, 123, 151, 113, 13, 217, 231, 43, 197, 231, 158, 102, 251, 29, 99, 25, 125, 8, 59, 61, 193, 140, 201, 119, 221, 40, 118, 13, 251, 220, 226, 159, 219, 58, 49, 147, 68, 214, 222, 212, 42, 70, 237, 220, 38, 187, 33, 26, 11, 205, 46, 19, 6, 125, 152, 27, 146, 87, 90, 168, 94, 15, 195, 252, 99, 211, 168, 129, 237, 67, 195, 234, 1, 173, 26, 200, 200, 32, 93, 52, 165, 210, 244, 43, 217, 9, 185, 27, 103, 10, 55, 212, 142, 65, 253, 22, 117, 137, 118, 166, 203, 2, 46, 123, 9, 189, 15, 179, 177, 26, 162, 206, 57, 11, 164, 11, 165, 176, 3, 37, 3, 141, 22, 167, 161, 114, 142, 79, 160, 90, 46, 144, 164, 34, 233, 118, 92, 154, 202, 106, 185, 63, 80, 187, 117, 12, 198, 135, 54, 151, 134, 68, 137, 80, 90, 240, 250, 204, 78, 163, 70, 125, 16, 79, 112, 240, 108, 129, 19, 114, 19, 163, 52, 127, 5, 74, 82, 230, 67, 203, 106, 78, 185, 172, 66, 59, 189, 87, 73, 146, 255, 143, 99, 105, 18, 254, 139, 95, 141, 80, 13, 229, 4, 183, 198, 144, 52, 198, 232, 42, 251, 132, 8, 103, 92, 202, 199, 114, 122, 44, 201, 205, 16, 5, 219, 135, 218, 237, 130, 101, 105, 44, 120, 130, 142, 79, 36, 153, 16, 251, 88, 181, 27, 203, 131, 221, 253, 78, 204, 141, 85, 114, 178, 0, 62, 238, 89, 148, 97, 5, 222, 180, 237, 32, 61, 221, 147, 186, 65, 182, 252, 199, 118, 112, 82, 34, 210, 186, 61, 117, 34, 238, 20, 44, 215, 74, 173, 130, 98, 60, 160, 80, 137, 76, 179, 64, 89, 203, 38, 149, 100, 1, 115, 110, 44, 7, 130, 71, 105, 31, 168, 234, 18, 129, 138, 98, 166, 153, 85, 255, 214, 113, 8, 41, 82, 33, 194, 108, 98, 63, 166, 211, 98, 129, 221, 159, 84, 73, 89, 225, 163, 100, 59, 130, 112, 71, 234, 79, 35, 119, 218, 125, 79, 173, 246, 74, 65, 114, 113, 236, 154, 10, 44, 127, 235, 100, 232, 104, 198, 69, 137, 170, 178, 134, 114, 130, 172, 110, 76, 159, 197, 8, 45, 167, 87, 103, 84, 129, 85, 60, 100, 224, 14, 3, 118, 136, 42, 232, 151, 120, 60, 193, 109, 89, 136, 211, 234, 153, 55, 184, 146, 160, 116, 87, 111, 210, 193, 162, 45, 143, 197, 128, 135, 219, 116, 34, 147, 139, 190, 5, 243, 219, 92, 96, 118, 249, 187, 251, 123, 166, 5, 205, 117, 139, 81, 178, 33, 187, 254, 125, 168, 243, 176, 178, 63, 102, 3, 65, 58, 32, 212, 160, 202, 190, 118, 162, 189, 151, 219, 123, 48, 255, 124, 96, 227, 129, 221, 226, 61, 201, 196, 24, 74, 61, 65, 169, 172, 220, 18, 76, 189, 210, 141, 20, 224, 152, 156, 165, 24, 8, 100, 113, 91, 51, 105, 186, 168, 87, 149, 18, 174, 74, 83, 185, 166, 198, 172, 79, 129, 121, 188, 35, 87, 136, 157, 101, 118, 52, 140, 21, 153, 29, 13, 113, 27, 104, 89, 200, 44, 203, 234, 40, 155, 36, 169, 98, 30, 80, 123, 82, 26, 22, 158, 42, 29, 62, 97, 145, 161, 218, 190, 179, 226, 193, 220, 182, 178, 76, 140, 176, 28, 206, 77, 170, 251, 53, 52, 129, 230, 177, 27, 6, 221, 220, 71, 5, 19, 225, 134, 10, 121, 151, 83, 129, 65, 237, 221, 151, 143, 95, 191, 181, 97, 225, 145, 12, 4, 205, 140, 178, 87, 158, 81, 83, 127, 157, 223, 77, 10, 112, 46, 153, 107, 87, 213, 128, 230, 11, 178, 111, 16, 39, 33, 174, 106, 119, 190, 115, 192, 204, 147, 87, 74, 208, 36, 66, 251, 238, 145, 233, 242, 70, 166, 199, 26, 5, 245, 10, 181, 25, 249, 212, 62, 244, 96, 54, 95, 17, 201, 111, 34, 248, 91, 252, 64, 11, 0, 0]);